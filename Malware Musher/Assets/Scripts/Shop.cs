using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;
using TMPro;

public class Shop : MonoBehaviour {

    [Header("Items")]
    public GunObject[] guns;
    public LaserObject[] lasers;
    public HealthObject[] healthObjects;
    public JumpObject[] jumpObjects;
    [Header("UI Objects")]
    public TMP_Text[] names;
    public TMP_Text[] descriptions;
    public TMP_Text[] costs;
    public Button[] buttons;
    [Header("Scripts")]
    public Gun gun;
    public Laser laser;
    public PlayerHealth playerHealth;
    public PlayerMovement playerMovement;
    public PlayerCoin playerCoin;

    private int gunIndex = 0;
    private int laserIndex = 0;
    private int healthObjectsIndex = 0;
    private int jumpObjectsIndex = 0;
    private bool isGun = true;
    private bool isCooldown = false;
    private int cooldown = 1;
    private bool itemPurchased1 = false;

    void Start() {

    }

    void Update() {
        if (isGun) {
            if (gunIndex > (guns.Length - 1)) {
                if (gun.cooldownTime == 0) {
                    isGun = false;
                } else {
                    names[1].text = "Cooldown";
                    descriptions[1].text = "Reduces cooldown for your current gun by one second";
                    costs[1].text = "5 coins";
                    isCooldown = true;
                }
            } else {
                names[1].text = guns[gunIndex].aName;
                descriptions[1].text = guns[gunIndex].aDescription;
                costs[1].text = guns[gunIndex].aCost + " coins";
                isCooldown = false;
            }
        } else if (!isGun) {
            if (laserIndex > (lasers.Length - 1)) {
                if (laser.cooldownTime == 0) {
                    names[1].text = "Out of Stock";
                    descriptions[1].text = "";
                    costs[1].text = "N/A";
                    buttons[1].enabled = false;
                } else {
                    names[1].text = "Cooldown";
                    descriptions[1].text = "Reduces cooldown for your current laser by one second";
                    costs[1].text = "5 coins";
                    isCooldown = true;
                }
            } else {
                names[1].text = lasers[laserIndex].aName;
                descriptions[1].text = lasers[laserIndex].aDescription;
                costs[1].text = lasers[laserIndex].aCost + " coins";
                isCooldown = false;
            }
        }
    }

    public void Puchase1() {
        if (isGun) {
            if ((!isCooldown) && (playerCoin.coins >= guns[gunIndex].aCost)) {
                guns[gunIndex].hasBeenPurchased = true;
                gun.gunObject = guns[gunIndex];
                playerCoin.coins -= guns[gunIndex].aCost;
                gunIndex++;
                isGun = false;
            } else if (playerCoin.coins >= 5) {
                gun.cooldownTime -= cooldown;
                isGun = false;
                playerCoin.coins -= 5;
            }
        } else {
            if ((!isCooldown) && (playerCoin.coins >= lasers[laserIndex].aCost)) {
                lasers[laserIndex].hasBeenPurchased = true;
                laser.laserObject = lasers[laserIndex];
                playerCoin.coins -= lasers[laserIndex].aCost;
                laserIndex++;
                isGun = true;
            } else if (playerCoin.coins >= 5) {
                laser.cooldownTime -= cooldown;
                isGun = true;
                playerCoin.coins -= 5;
            }
        }
    }

    public void Puchase2() {

    }

    public void Puchase3() {

    }
}
