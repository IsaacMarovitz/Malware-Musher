using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;
using TMPro;

public class LoadUI : MonoBehaviour {

    public TMP_Text[] loadText;
    public Button[] loadButtons;
    public GameObject loadMenu;
    public GameObject player;
    public GameObject cm1;
    public GameObject cm2;
    public SaveManager saveManager;

    private GameManager gameManager;
    private string[] filePaths = new string[3] { "save1.dat", "save2.dat", "save3.dat" };
    private bool[] fileCheck;
    private int fileIndex;

    // Start is called before the first frame update
    void Start() {
        saveManager = GetComponent<SaveManager>();
        gameManager = GameObject.Find("Game Manager").GetComponent<GameManager>();
        fileCheck = saveManager.CheckFiles(filePaths);
    }

    // Update is called once per frame
    void Update() {
        if (loadMenu.activeSelf) {
            for (int i = 0; i < fileCheck.Length; i++) {
                if (fileCheck[i]) {
                    loadText[i].text = saveManager.Load(filePaths[i]).saveTime;
                } else {
                    loadText[i].text = "No save";
                }
            }
        }
    }

    public void Load(int index) {
        if (fileCheck[index]) {
            gameManager.levelObjects = saveManager.Load(filePaths[index]).levelSaveData;
        } 
        loadMenu.SetActive(false);
        player.SetActive(true);
        cm1.SetActive(true);
        cm2.SetActive(false);
    }
}
