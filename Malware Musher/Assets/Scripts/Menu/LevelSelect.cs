using UnityEngine;
using UnityEngine.UI;

public class LevelSelect : MenuScript {

    public Button continueButton; 
    public SaveManager saveManager;
    public GameObject levelSelectButtonPrefab;
    public Transform buttonHolder;
    public GameObject loadingBar;

    public override void Start() {
        base.Start();
        continueButton.onClick.AddListener(Continue);
    }

    public void LoadSave(int save) {
        LevelObject levels = saveManager.LoadGameData(save);
        for (int i = 0; i < levels.levelList.Count; i++) {
            GameObject instantiatedUI = GameObject.Instantiate(levelSelectButtonPrefab, Vector3.zero, Quaternion.identity);
            bool interactable;
            if (levels.levelList[i].level == LevelState.Locked) {
                interactable = false;
            } else {
                interactable = true;
            }
            instantiatedUI.GetComponent<LevelSelectButton>().SetValue(i, this, interactable);
            instantiatedUI.transform.SetParent(buttonHolder);
            instantiatedUI.transform.localScale = new Vector3(1, 1, 1);
            instantiatedUI.GetComponent<RectTransform>().localPosition = Vector3.zero;
        }
    }

    public void Continue() {
        saveManager.Continue();
    }

    public void LoadLevel(int levelIndex) {
        saveManager.LoadLevel(levelIndex);
        loadingBar.SetActive(true);
        this.gameObject.SetActive(false);
    }
}